<!DOCTYPE html>
<html>
  <head>
    <title>Viewer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/lib/jQueryUI-1.11.4/jquery-ui.css">
    <style type="text/css">
      html, body, iframe, div { margin: 0; padding: 0; outline: 0; }
      html, body { height: 100%; width: 100%; cursor: default; }
      #container { z-index: 2; min-height: 100%; height: 100%; min-width: 800px; width: 100%; position: absolute; overflow: hidden; text-align: center; background: #dfdfdf; }     
      #document { z-index: 3; position: absolute; top: 0px; left: 0px; right: 0px; bottom: 0px; overflow: hidden; background:url(images/loading.gif) no-repeat center center; background-color: #fff; }              
    </style>
    <script src="/lib/underscore-1.8.3/underscore.js"></script>
    <script src="/lib/jquery-1.11.3/jquery.js"></script>
    <script src="/lib/jQueryUI-1.11.4/jquery-ui.js"></script>
    <script>
      var sbw = 16;
      function getEmbedString(docurl, ext) {
        if ($.inArray(ext, ['jpg', 'jepg', 'png', 'gif', 'tiff', 'tif', 'bmp']) >= 0) {
          return "<img id='docframeImg' src='" + docurl + "' style='height:100%'>";
        } else {
          return "<iframe id='docframePdf' src='" + docurl + "' style='width:100%; height:100%'/>";
        }
      }
      function resize() {
        $('.ui-dialog').css({
          'width': $(window).width() - sbw,
          'height': $(window).height() - sbw,
          'left': '0px',
          'top': '0px'
        })
      }
      $(document).ready(function () {
        var params = (window.location.search || '/docs/test.pdf|pdf').replace('?', '').split('|');
        console.log(params);
        var doc = params[0];
        var ext = params[1];
        var width = params[2];
        var height = params[3];
        $('#document').html(getEmbedString(doc, ext));
        $('#dlgViewer').dialog({
          open: resize,
          title: 'Anzeige' + doc,
          closeText: 'Schlie\u00dfen',
          width: width,
          height: height,
          closeOnEscape: false,
          draggable: false,
          resizable: false,
          close: function () {
            $(this).dialog("close");
            window.close();
          },
          buttons: {
            'Position merken': function () {
            },
            'Lokaler Druck': function () {
            },
            'Abbrechen': function () {
              $(this).dialog("close");
              window.close();
            }
          }
        });
        $(window).resize();
      });
      $(window).resize(resize);

    </script>
  </head>
  <body>
    <div id='dlgViewer'>
      <div id="document">
      </div>
    </div>
  </body>
</html>
